const q="0.9.0";let Ft=!1,Q,Bt,St,Wt,Ht,Xt;function ae(n,t={auto:!1}){if(Ft)throw new Error(`you must \`import 'together-ai/shims/${n.kind}'\` before importing anything else from together-ai`);if(Q)throw new Error(`can't \`import 'together-ai/shims/${n.kind}'\` after \`import 'together-ai/shims/${Q}'\``);Ft=t.auto,Q=n.kind,Bt=n.fetch,St=n.File,Wt=n.ReadableStream,Ht=n.getDefaultAgent,Xt=n.fileFromPath}class ce{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}function le({manuallyImported:n}={}){const t=n?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'together-ai'`:\n- `import 'together-ai/shims/node'` (if you're running on Node)\n- `import 'together-ai/shims/web'` (otherwise)\n";let e,r,s,i;try{e=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${t}`)}return{kind:"web",fetch:e,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(o,a)=>({...a,body:new ce(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/togethercomputer/together-typescript#file-uploads")},isFsReadStream:o=>!1}}Q||ae(le(),{auto:!0});class j{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const r=j.NEWLINE_CHARS.has(e[e.length-1]||"");let s=e.split(j.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(t){if(t==null)return"";if(typeof t=="string")return t;if(typeof Buffer<"u"){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new p(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new p(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new p("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}j.NEWLINE_CHARS=new Set([`
`,"\r"]);j.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class v{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of ue(t,e))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null){let a;try{a=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(a&&a.error)throw new S(void 0,a.error,void 0,void 0);yield a}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||e.abort()}}return new v(s,e)}static fromReadableStream(t,e){let r=!1;async function*s(){const o=new j,a=Jt(t);for await(const u of a)for(const f of o.decode(u))yield f;for(const u of o.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const a of s())o||a&&(yield JSON.parse(a));o=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{o||e.abort()}}return new v(i,e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();t.push(o),e.push(o)}return i.shift()}});return[new v(()=>s(t),this.controller),new v(()=>s(e),this.controller)]}toReadableStream(){const t=this;let e;const r=new TextEncoder;return new Wt({async start(){e=t[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await e.next();if(o)return s.close();const a=r.encode(JSON.stringify(i)+`
`);s.enqueue(a)}catch(i){s.error(i)}},async cancel(){var s;await((s=e.return)==null?void 0:s.call(e))}})}}async function*ue(n,t){if(!n.body)throw t.abort(),new p("Attempted to iterate over a response with no body");const e=new de,r=new j,s=Jt(n.body);for await(const i of fe(s))for(const o of r.decode(i)){const a=e.decode(o);a&&(yield a)}for(const i of r.flush()){const o=e.decode(i);o&&(yield o)}}async function*fe(n){let t=new Uint8Array;for await(const e of n){if(e==null)continue;const r=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let s=new Uint8Array(t.length+r.length);s.set(t),s.set(r,t.length),t=s;let i;for(;(i=he(t))!==-1;)yield t.slice(0,i),t=t.slice(i)}t.length>0&&(yield t)}function he(n){for(let r=0;r<n.length-2;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}class de{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,r,s]=me(t,":");return s.startsWith(" ")&&(s=s.substring(1)),e==="event"?this.event=s:e==="data"&&this.data.push(s),null}}function me(n,t){const e=n.indexOf(t);return e!==-1?[n.substring(0,e),t,n.substring(e+t.length)]:[n,"",""]}function Jt(n){if(n[Symbol.asyncIterator])return n;const t=n.getReader();return{async next(){try{const e=await t.read();return e!=null&&e.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const pe=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",ge=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&pt(n),pt=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function";async function ye(n,t,e){var s;if(n=await n,ge(n))return n;if(pe(n)){const i=await n.blob();t||(t=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=pt(i)?[await i.arrayBuffer()]:[i];return new St(o,t,e)}const r=await we(n);if(t||(t=be(n)??"unknown_file"),!(e!=null&&e.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(e={...e,type:i})}return new St(r,t,e)}async function we(n){var e;let t=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)t.push(n);else if(pt(n))t.push(await n.arrayBuffer());else if(Ce(n))for await(const r of n)t.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(e=n==null?void 0:n.constructor)==null?void 0:e.name}; props: ${_e(n)}`);return t}function _e(n){return`[${Object.getOwnPropertyNames(n).map(e=>`"${e}"`).join(", ")}]`}function be(n){var t;return wt(n.name)||wt(n.filename)||((t=wt(n.path))==null?void 0:t.split(/[\\/]/).pop())}const wt=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},Ce=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",Tt=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody";var W={};async function Vt(n){const{response:t}=n;if(n.options.stream)return H("response",t.status,t.url,t.headers,t.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(t,n.controller):v.fromSSEResponse(t,n.controller);if(t.status===204)return null;if(n.options.__binaryResponse)return t;const e=t.headers.get("content-type");if((e==null?void 0:e.includes("application/json"))||(e==null?void 0:e.includes("application/vnd.api+json"))){const i=await t.json();return H("response",t.status,t.url,t.headers,i),i}const s=await t.text();return H("response",t.status,t.url,t.headers,s),s}class gt extends Promise{constructor(t,e=Vt){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new gt(this.responsePromise,async e=>t(await this.parseResponse(e),e))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class Re{constructor({baseURL:t,maxRetries:e=5,timeout:r=6e4,httpAgent:s,fetch:i}){this.baseURL=t,this.maxRetries=_t("maxRetries",e),this.timeout=_t("timeout",r),this.httpAgent=s,this.fetch=i??Bt}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ke(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${Ne()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&pt(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:t,path:e,...s,body:i}}))}getAPIList(t,e,r){return this.requestAPIList(e,{method:"get",path:t,...r})}calculateContentLength(t){if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.byteLength(t,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:e=0}={}){var C;const{method:r,path:s,query:i,headers:o={}}=t,a=ArrayBuffer.isView(t.body)||t.__binaryRequest&&typeof t.body=="string"?t.body:Tt(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,u=this.calculateContentLength(a),f=this.buildURL(s,i);"timeout"in t&&_t("timeout",t.timeout);const w=t.timeout??this.timeout,g=t.httpAgent??this.httpAgent??Ht(f),_=w+1e3;typeof((C=g==null?void 0:g.options)==null?void 0:C.timeout)=="number"&&_>(g.options.timeout??0)&&(g.options.timeout=_),this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const h=this.buildHeaders({options:t,headers:o,contentLength:u,retryCount:e});return{req:{method:r,...a&&{body:a},headers:h,...g&&{agent:g},signal:t.signal??null},url:f,timeout:w}}buildHeaders({options:t,headers:e,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(t);return Ut(i,o),Ut(i,e),Tt(t.body)&&Q!=="node"&&delete i["content-type"],Lt(o,"x-stainless-retry-count")===void 0&&Lt(e,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,e),i}async prepareOptions(t){}async prepareRequest(t,{url:e,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map(e=>[...e])):{...t}:{}}makeStatusError(t,e,r,s){return S.generate(t,e,r,s)}request(t,e=null){return new gt(this.makeRequest(t,e))}async makeRequest(t,e){var g,_;const r=await t,s=r.maxRetries??this.maxRetries;e==null&&(e=s),await this.prepareOptions(r);const{req:i,url:o,timeout:a}=this.buildRequest(r,{retryCount:s-e});if(await this.prepareRequest(i,{url:o,options:r}),H("request",o,r,i.headers),(g=r.signal)!=null&&g.aborted)throw new D;const u=new AbortController,f=await this.fetchWithTimeout(o,i,a,u).catch(Et);if(f instanceof Error){if((_=r.signal)!=null&&_.aborted)throw new D;if(e)return this.retryRequest(r,e);throw f.name==="AbortError"?new Kt:new yt({cause:f})}const w=Ee(f.headers);if(!f.ok){if(e&&this.shouldRetry(f)){const m=`retrying, ${e} attempts remaining`;return H(`response (error; ${m})`,f.status,o,w),this.retryRequest(r,e,w)}const h=await f.text().catch(m=>Et(m).message),d=Pe(h),C=d?void 0:h;throw H(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,f.status,o,w,C),this.makeStatusError(f.status,d,C,w)}return{response:f,options:r,controller:u}}requestAPIList(t,e){const r=this.makeRequest(e,null);return new Se(this,r,t)}buildURL(t,e){const r=Me(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),s=this.defaultQuery();return Te(s)||(e={...s,...e}),typeof e=="object"&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}stringifyQuery(t){return Object.entries(t).filter(([e,r])=>typeof r<"u").map(([e,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(e)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(e)}=`;throw new p(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(t,e,r,s){const{signal:i,...o}=e||{};i&&i.addEventListener("abort",()=>s.abort());const a=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,t,{signal:s.signal,...o}).finally(()=>{clearTimeout(a)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return e==="true"?!0:e==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,e,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const a=parseFloat(i);Number.isNaN(a)||(s=a)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const a=parseFloat(o);Number.isNaN(a)?s=Date.parse(o)-Date.now():s=a*1e3}if(!(s&&0<=s&&s<60*1e3)){const a=t.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(e,a)}return await Fe(s),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const i=e-t,o=Math.min(1*Math.pow(2,i),10),a=1-Math.random()*.25;return o*a*1e3}getUserAgent(){return`${this.constructor.name}/JS ${q}`}}class Se extends gt{constructor(t,e,r){super(e,async s=>new r(t,s.response,await Vt(s),s.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const e of t)yield e}}const Ee=n=>new Proxy(Object.fromEntries(n.entries()),{get(t,e){const r=e.toString();return t[r.toLowerCase()]||t[r]}}),Ae=()=>{var t;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":q,"X-Stainless-OS":Nt(Deno.build.os),"X-Stainless-Arch":Ot(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((t=Deno.version)==null?void 0:t.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":q,"X-Stainless-OS":Nt(process.platform),"X-Stainless-Arch":Ot(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=xe();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":q,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xe(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:e}of n){const r=e.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:t,version:`${s}.${i}.${o}`}}}return null}const Ot=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Nt=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let vt;const ke=()=>vt??(vt=Ae()),Pe=n=>{try{return JSON.parse(n)}catch{return}},$e=new RegExp("^(?:[a-z]+:)?//","i"),Me=n=>$e.test(n),Fe=n=>new Promise(t=>setTimeout(t,n)),_t=(n,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new p(`${n} must be an integer`);if(t<0)throw new p(`${n} must be a positive integer`);return t},Et=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},It=n=>{var t,e,r,s;if(typeof process<"u")return((t=W==null?void 0:W[n])==null?void 0:t.trim())??void 0;if(typeof Deno<"u")return(s=(r=(e=Deno.env)==null?void 0:e.get)==null?void 0:r.call(e,n))==null?void 0:s.trim()};function Te(n){if(!n)return!0;for(const t in n)return!1;return!0}function Oe(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function Ut(n,t){for(const e in t){if(!Oe(t,e))continue;const r=e.toLowerCase();if(!r)continue;const s=t[e];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}function H(n,...t){typeof process<"u"&&(W==null?void 0:W.DEBUG)==="true"&&console.log(`Together:DEBUG:${n}`,...t)}const Ne=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const t=Math.random()*16|0;return(n==="x"?t:t&3|8).toString(16)}),ve=n=>typeof(n==null?void 0:n.get)=="function",Lt=(n,t)=>{var r;const e=t.toLowerCase();if(ve(n)){const s=((r=t[0])==null?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(i,o,a)=>o+a.toUpperCase());for(const i of[t,e,t.toUpperCase(),s]){const o=n.get(i);if(o)return o}}for(const[s,i]of Object.entries(n))if(s.toLowerCase()===e)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${t} header, using the first entry.`),i[0]):i};class p extends Error{}class S extends p{constructor(t,e,r,s){super(`${S.makeMessage(t,e,r)}`),this.status=t,this.headers=s,this.error=e}static makeMessage(t,e,r){const s=e!=null&&e.message?typeof e.message=="string"?e.message:JSON.stringify(e.message):e?JSON.stringify(e):r;return t&&s?`${t} ${s}`:t?`${t} status code (no body)`:s||"(no status code or body)"}static generate(t,e,r,s){if(!t)return new yt({message:r,cause:Et(e)});const i=e;return t===400?new Gt(t,i,r,s):t===401?new Qt(t,i,r,s):t===403?new zt(t,i,r,s):t===404?new Yt(t,i,r,s):t===409?new Zt(t,i,r,s):t===422?new te(t,i,r,s):t===429?new ee(t,i,r,s):t>=500?new ne(t,i,r,s):new S(t,i,r,s)}}class D extends S{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class yt extends S{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class Kt extends yt{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Gt extends S{constructor(){super(...arguments),this.status=400}}class Qt extends S{constructor(){super(...arguments),this.status=401}}class zt extends S{constructor(){super(...arguments),this.status=403}}class Yt extends S{constructor(){super(...arguments),this.status=404}}class Zt extends S{constructor(){super(...arguments),this.status=409}}class te extends S{constructor(){super(...arguments),this.status=422}}class ee extends S{constructor(){super(...arguments),this.status=429}}class ne extends S{}class I{constructor(t){this._client=t}}function jt(n){return typeof n.parse=="function"}const z=n=>(n==null?void 0:n.role)==="assistant",re=n=>(n==null?void 0:n.role)==="function",se=n=>(n==null?void 0:n.role)==="tool";var P=function(n,t,e,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?n!==t||!s:!t.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,e):s?s.value=e:t.set(n,e),e},l=function(n,t,e,r){if(e==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?n!==t||!r:!t.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?r:e==="a"?r.call(n):r?r.value:t.get(n)},R,tt,et,J,V,nt,K,O,G,rt,st,B,At,it,xt,kt,Pt,$t,ie,Mt;const Dt=10;class Ie{constructor(){R.add(this),this.controller=new AbortController,tt.set(this,void 0),et.set(this,()=>{}),J.set(this,()=>{}),V.set(this,void 0),nt.set(this,()=>{}),K.set(this,()=>{}),O.set(this,{}),this._chatCompletions=[],this.messages=[],G.set(this,!1),rt.set(this,!1),st.set(this,!1),B.set(this,!1),$t.set(this,t=>{if(P(this,rt,!0,"f"),t instanceof Error&&t.name==="AbortError"&&(t=new D),t instanceof D)return P(this,st,!0,"f"),this._emit("abort",t);if(t instanceof p)return this._emit("error",t);if(t instanceof Error){const e=new e(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new p(String(t)))}),P(this,tt,new Promise((t,e)=>{P(this,et,t,"f"),P(this,J,e,"f")}),"f"),P(this,V,new Promise((t,e)=>{P(this,nt,t,"f"),P(this,K,e,"f")}),"f"),l(this,tt,"f").catch(()=>{}),l(this,V,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},l(this,$t,"f"))},0)}_addChatCompletion(t){var r;this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=(r=t.choices[0])==null?void 0:r.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e){if(this._emit("message",t),(re(t)||se(t))&&t.content)this._emit("functionCallResult",t.content);else if(z(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(z(t)&&t.tool_calls)for(const r of t.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}_connected(){this.ended||(l(this,et,"f").call(this),this._emit("connect"))}get ended(){return l(this,G,"f")}get errored(){return l(this,rt,"f")}get aborted(){return l(this,st,"f")}abort(){this.controller.abort()}on(t,e){return(l(this,O,"f")[t]||(l(this,O,"f")[t]=[])).push({listener:e}),this}off(t,e){const r=l(this,O,"f")[t];if(!r)return this;const s=r.findIndex(i=>i.listener===e);return s>=0&&r.splice(s,1),this}once(t,e){return(l(this,O,"f")[t]||(l(this,O,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,r)=>{P(this,B,!0,"f"),t!=="error"&&this.once("error",r),this.once(t,e)})}async done(){P(this,B,!0,"f"),await l(this,V,"f")}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new p("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),l(this,R,"m",At).call(this)}async finalMessage(){return await this.done(),l(this,R,"m",it).call(this)}async finalFunctionCall(){return await this.done(),l(this,R,"m",xt).call(this)}async finalFunctionCallResult(){return await this.done(),l(this,R,"m",kt).call(this)}async totalUsage(){return await this.done(),l(this,R,"m",Pt).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(t,...e){if(l(this,G,"f"))return;t==="end"&&(P(this,G,!0,"f"),l(this,nt,"f").call(this));const r=l(this,O,"f")[t];if(r&&(l(this,O,"f")[t]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...e))),t==="abort"){const s=e[0];!l(this,B,"f")&&!(r!=null&&r.length)&&Promise.reject(s),l(this,J,"f").call(this,s),l(this,K,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=e[0];!l(this,B,"f")&&!(r!=null&&r.length)&&Promise.reject(s),l(this,J,"f").call(this,s),l(this,K,"f").call(this,s),this._emit("end")}}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=l(this,R,"m",it).call(this);e&&this._emit("finalMessage",e);const r=l(this,R,"m",At).call(this);r&&this._emit("finalContent",r);const s=l(this,R,"m",xt).call(this);s&&this._emit("finalFunctionCall",s);const i=l(this,R,"m",kt).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",l(this,R,"m",Pt).call(this))}async _createChatCompletion(t,e,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),l(this,R,"m",ie).call(this,e);const i=await t.create({...e,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(t,e,r){for(const s of e.messages)this._addMessage(s,!1);return await this._createChatCompletion(t,e,r)}async _runFunctions(t,e,r){var _;const s="function",{function_call:i="auto",stream:o,...a}=e,u=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:f=Dt}=r||{},w={};for(const h of e.functions)w[h.name||h.function.name]=h;const g=e.functions.map(h=>({name:h.name||h.function.name,parameters:h.parameters,description:h.description}));for(const h of e.messages)this._addMessage(h,!1);for(let h=0;h<f;++h){const C=(_=(await this._createChatCompletion(t,{...a,function_call:i,functions:g,messages:[...this.messages]},r)).choices[0])==null?void 0:_.message;if(!C)throw new p("missing message in ChatCompletion response");if(!C.function_call)return;const{name:c,arguments:E}=C.function_call,m=w[c];if(m){if(u&&u!==c){const A=`Invalid function_call: ${JSON.stringify(c)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,name:c,content:A});continue}}else{const A=`Invalid function_call: ${JSON.stringify(c)}. Available options are: ${g.map(T=>JSON.stringify(T.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:c,content:A});continue}let x;try{x=jt(m)?await m.parse(E):E}catch(A){this._addMessage({role:s,name:c,content:A instanceof Error?A.message:String(A)});continue}const M=await m.function(x,this),k=l(this,R,"m",Mt).call(this,M);if(this._addMessage({role:s,name:c,content:k}),u)return}}async _runTools(t,e,r){var _,h;const s="tool",{tool_choice:i="auto",stream:o,...a}=e,u=typeof i!="string"&&((_=i==null?void 0:i.function)==null?void 0:_.name),{maxChatCompletions:f=Dt}=r||{},w={};for(const d of e.tools)d.type==="function"&&(w[d.function.name||d.function.function.name]=d.function);const g="tools"in e?e.tools.map(d=>d.type==="function"?{type:"function",function:{name:d.function.name||d.function.function.name,parameters:d.function.parameters,description:d.function.description}}:d):void 0;for(const d of e.messages)this._addMessage(d,!1);for(let d=0;d<f;++d){const c=(h=(await this._createChatCompletion(t,{...a,tool_choice:i,tools:g,messages:[...this.messages]},r)).choices[0])==null?void 0:h.message;if(!c)throw new p("missing message in ChatCompletion response");if(!c.tool_calls)return;for(const E of c.tool_calls){if(E.type!=="function")continue;const m=E.id,{name:x,arguments:M}=E.function,k=w[x];if(k){if(u&&u!==x){const b=`Invalid tool_call: ${JSON.stringify(x)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,tool_call_id:m,content:b});continue}}else{const b=`Invalid tool_call: ${JSON.stringify(x)}. Available options are: ${g.map(X=>JSON.stringify(X.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:m,content:b});continue}let A;try{A=jt(k)?await k.parse(M):M}catch(b){const X=b instanceof Error?b.message:String(b);this._addMessage({role:s,tool_call_id:m,content:X});continue}const T=await k.function(A,this),U=l(this,R,"m",Mt).call(this,T);if(this._addMessage({role:s,tool_call_id:m,content:U}),u)return}}}}tt=new WeakMap,et=new WeakMap,J=new WeakMap,V=new WeakMap,nt=new WeakMap,K=new WeakMap,O=new WeakMap,G=new WeakMap,rt=new WeakMap,st=new WeakMap,B=new WeakMap,$t=new WeakMap,R=new WeakSet,At=function(){return l(this,R,"m",it).call(this).content??null},it=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(z(e))return{...e,content:e.content??null}}throw new p("stream ended without producing a ChatCompletionMessage with role=assistant")},xt=function(){var t,e;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(z(s)&&(s!=null&&s.function_call))return s.function_call;if(z(s)&&((t=s==null?void 0:s.tool_calls)!=null&&t.length))return(e=s.tool_calls.at(-1))==null?void 0:e.function}},kt=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(re(e)&&e.content!=null||se(e)&&e.content!=null&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===e.tool_call_id))}))return e.content}},Pt=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},ie=function(t){if(t.n!=null&&t.n>1)throw new p("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Mt=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};var $=function(n,t,e,r){if(e==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?n!==t||!r:!t.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?r:e==="a"?r.call(n):r?r.value:t.get(n)},bt=function(n,t,e,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?n!==t||!s:!t.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,e):s?s.value=e:t.set(n,e),e},F,N,Ct,Rt,Y,qt;class ot extends Ie{constructor(){super(...arguments),F.add(this),N.set(this,void 0)}get currentChatCompletionSnapshot(){return $(this,N,"f")}static fromReadableStream(t){const e=new ot;return e._run(()=>e._fromReadableStream(t)),e}static createChatCompletion(t,e,r){const s=new ot;return s._run(()=>s._runChatCompletion(t,{...e,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(t,e,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),$(this,F,"m",Ct).call(this);const i=await t.create({...e,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const a of i)$(this,F,"m",Rt).call(this,a);if((o=i.controller.signal)!=null&&o.aborted)throw new D;return this._addChatCompletion($(this,F,"m",Y).call(this))}async _fromReadableStream(t,e){var o;const r=e==null?void 0:e.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),$(this,F,"m",Ct).call(this),this._connected();const s=v.fromReadableStream(t,this.controller);let i;for await(const a of s)i&&i!==a.id&&this._addChatCompletion($(this,F,"m",Y).call(this)),$(this,F,"m",Rt).call(this,a),i=a.id;if((o=s.controller.signal)!=null&&o.aborted)throw new D;return this._addChatCompletion($(this,F,"m",Y).call(this))}[(N=new WeakMap,F=new WeakSet,Ct=function(){this.ended||bt(this,N,void 0,"f")},Rt=function(e){var o,a,u;if(this.ended)return;const r=$(this,F,"m",qt).call(this,e);this._emit("chunk",e,r);const s=(a=(o=e.choices[0])==null?void 0:o.delta)==null?void 0:a.content,i=(u=r.choices[0])==null?void 0:u.message;s!=null&&(i==null?void 0:i.role)==="assistant"&&(i!=null&&i.content)&&this._emit("content",s,i.content)},Y=function(){if(this.ended)throw new p("stream has ended, this shouldn't happen");const e=$(this,N,"f");if(!e)throw new p("request ended without sending any chunks");return bt(this,N,void 0,"f"),Ue(e)},qt=function(e){var r,s,i,o,a;let u=$(this,N,"f");const{choices:f,...w}=e;u?Object.assign(u,w):u=bt(this,N,{...w,choices:[]},"f");for(const{delta:g,finish_reason:_,index:h,logprobs:d=null,...C}of e.choices){let c=u.choices[h];if(c||(c=u.choices[h]={finish_reason:_,index:h,message:{},logprobs:{token_ids:[],token_logprobs:[],tokens:[]},...C}),d&&(console.log({logprobs:d}),c.logprobs||(c.logprobs={token_ids:[],token_logprobs:[],tokens:[]}),(r=c.logprobs).token_ids??(r.token_ids=[]),c.logprobs.token_ids.push(g.token_id??null),(s=c.logprobs).token_logprobs??(s.token_logprobs=[]),c.logprobs.token_logprobs.push(d??null),(i=c.logprobs).tokens??(i.tokens=[]),c.logprobs.tokens.push(g.content??null)),_&&(c.finish_reason=_),Object.assign(c,C),!g)continue;const{content:E,function_call:m,role:x,tool_calls:M,...k}=g;if(Object.assign(c.message,k),E&&(c.message.content=(c.message.content||"")+E),x&&(c.message.role=x),m&&(c.message.function_call?(m.name&&(c.message.function_call.name=m.name),m.arguments&&((o=c.message.function_call).arguments??(o.arguments=""),c.message.function_call.arguments+=m.arguments)):c.message.function_call=m),M){c.message.tool_calls||(c.message.tool_calls=[]);for(const{index:A,id:T,type:U,function:b,...X}of M){const L=(a=c.message.tool_calls)[A]??(a[A]={});Object.assign(L,X),T&&(L.id=T),U&&(L.type=U),b&&(L.function??(L.function={arguments:""})),b!=null&&b.name&&(L.function.name=b.name),b!=null&&b.arguments&&(L.function.arguments+=b.arguments)}}}return u},Symbol.asyncIterator)](){const t=[],e=[];let r=!1;return this.on("chunk",s=>{const i=e.shift();i?i.resolve(s):t.push(s)}),this.on("end",()=>{r=!0;for(const s of e)s.resolve(void 0);e.length=0}),this.on("abort",s=>{r=!0;for(const i of e)i.reject(s);e.length=0}),this.on("error",s=>{r=!0;for(const i of e)i.reject(s);e.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>e.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new v(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ue(n){const{id:t,choices:e,created:r,model:s,system_fingerprint:i,...o}=n;return{...o,id:t,choices:e.map(({message:a,finish_reason:u,index:f,logprobs:w,...g})=>{if(!u)throw new p(`missing finish_reason for choice ${f}`);const{content:_=null,function_call:h,tool_calls:d,...C}=a,c=a.role;if(!c)throw new p(`missing role for choice ${f}`);if(h){const{arguments:E,name:m}=h;if(E==null)throw new p(`missing function_call.arguments for choice ${f}`);if(!m)throw new p(`missing function_call.name for choice ${f}`);return{...g,message:{content:_,function_call:{arguments:E,name:m},role:c},finish_reason:u,index:f,logprobs:w}}return d?{...g,index:f,finish_reason:u,logprobs:w,message:{...C,role:c,content:_,tool_calls:d.map((E,m)=>{const{function:x,type:M,id:k,...A}=E,{arguments:T,name:U,...b}=x||{};if(k==null)throw new p(`missing choices[${f}].tool_calls[${m}].id
${Z(n)}`);if(M==null)throw new p(`missing choices[${f}].tool_calls[${m}].type
${Z(n)}`);if(U==null)throw new p(`missing choices[${f}].tool_calls[${m}].function.name
${Z(n)}`);if(T==null)throw new p(`missing choices[${f}].tool_calls[${m}].function.arguments
${Z(n)}`);return{...A,id:k,type:M,function:{...b,name:U,arguments:T}}})}}:{...g,message:{...C,content:_,role:c},finish_reason:u,index:f,logprobs:w}}),created:r,model:s,object:"chat.completion",...i?{system_fingerprint:i}:{}}}function Z(n){return JSON.stringify(n)}let at=class extends I{create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}stream(t,e){return ot.createChatCompletion(this._client.chat.completions,t,e)}};at||(at={});class ct extends I{constructor(){super(...arguments),this.completions=new at(this._client)}}(function(n){n.Completions=at})(ct||(ct={}));class lt extends I{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}lt||(lt={});class ut extends I{create(t,e){return this._client.post("/embeddings",{body:t,...e})}}ut||(ut={});class ft extends I{retrieve(t,e){return this._client.get(`/files/${t}`,e)}list(t){return this._client.get("/files",t)}delete(t,e){return this._client.delete(`/files/${t}`,e)}content(t,e){return this._client.get(`/files/${t}/content`,{...e,__binaryResponse:!0})}upload(t){throw"please use together-ai/lib/upload"}}ft||(ft={});class ht extends I{create(t,e){return this._client.post("/fine-tunes",{body:t,...e})}retrieve(t,e){return this._client.get(`/fine-tunes/${t}`,e)}list(t){return this._client.get("/fine-tunes",t)}cancel(t,e){return this._client.post(`/fine-tunes/${t}/cancel`,e)}download(t,e){return this._client.get("/finetune/download",{query:t,...e})}listEvents(t,e){return this._client.get(`/fine-tunes/${t}/events`,e)}}ht||(ht={});class dt extends I{create(t,e){return this._client.post("/images/generations",{body:t,...e})}}dt||(dt={});class mt extends I{list(t){return this._client.get("/models",t)}}mt||(mt={});var oe;class y extends Re{constructor({baseURL:t=It("TOGETHER_BASE_URL"),apiKey:e=It("TOGETHER_API_KEY"),...r}={}){if(e===void 0)throw new p("The TOGETHER_API_KEY environment variable is missing or empty; either provide it, or instantiate the Together client with an apiKey option, like new Together({ apiKey: 'My API Key' }).");const s={apiKey:e,...r,baseURL:t||"https://api.together.xyz/v1"};super({baseURL:s.baseURL,timeout:s.timeout??6e4,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.chat=new ct(this),this.completions=new lt(this),this.embeddings=new ut(this),this.files=new ft(this),this.fineTune=new ht(this),this.images=new dt(this),this.models=new mt(this),this._options=s,this.apiKey=e}rerank(t,e){return this.post("/rerank",{body:t,...e})}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}oe=y;y.Together=oe;y.DEFAULT_TIMEOUT=6e4;y.TogetherError=p;y.APIError=S;y.APIConnectionError=yt;y.APIConnectionTimeoutError=Kt;y.APIUserAbortError=D;y.NotFoundError=Yt;y.ConflictError=Zt;y.RateLimitError=ee;y.BadRequestError=Gt;y.AuthenticationError=Qt;y.InternalServerError=ne;y.PermissionDeniedError=zt;y.UnprocessableEntityError=te;y.toFile=ye;y.fileFromPath=Xt;(function(n){n.Chat=ct,n.Completions=lt,n.Embeddings=ut,n.Files=ft,n.FineTuneResource=ht,n.Images=dt,n.Models=mt})(y||(y={}));const Le=new y({apiKey:"8916aa5dd5a189dbf006f0e0fb4dd1874c3824b05c301cd13af93e02c8693622"});chrome.runtime.onMessage.addListener((n,t,e)=>{var r;return n.type==="CHAT_MESSAGE"&&(e({status:"processing"}),je(n.text,(r=t.tab)==null?void 0:r.id)),!0});async function je(n,t){var e,r;try{const s=await Le.chat.completions.create({messages:[{role:"user",content:n}],model:"meta-llama/Llama-3.2-11B-Vision-Instruct-Turbo",max_tokens:1500,temperature:.7,top_p:.7,top_k:50,repetition_penalty:1,stop:["<|eot_id|>","<|eom_id|>"],stream:!0});let i="";for await(const o of s){const a=((r=(e=o.choices[0])==null?void 0:e.delta)==null?void 0:r.content)||"";i+=a,t&&chrome.tabs.sendMessage(t,{type:"CHAT_RESPONSE_CHUNK",content:a,isComplete:!1})}t&&chrome.tabs.sendMessage(t,{type:"CHAT_RESPONSE_CHUNK",content:"",isComplete:!0,fullResponse:i})}catch(s){console.error("Error in chat:",s),t&&chrome.tabs.sendMessage(t,{type:"CHAT_ERROR",error:"Failed to get response from AI"})}}
